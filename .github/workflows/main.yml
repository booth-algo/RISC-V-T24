# Install act as a GitHub CLI extension to run locally
# https://github.com/nektos/act
# Then run "gh act"

name: integration

on:
    push:
        branches:
            - '*'
    pull_request:
        branches:
            - '*'

jobs:
    test:
        runs-on: ubuntu-latest
        steps:
            - name: setup-folder
              uses: actions/checkout@v2
            
            - name: setup-dependencies
              run: |
                sudo apt update
                sudo apt install -y libgtest-dev lcov verilator
            
            - name: run-tests
              run: |
                cd tb
                ./doit.sh
            
            - name: upload-code-coverage-report
              uses: actions/upload-artifact@v2
              with:
                name: code-coverage-report
                path: tb/logs/html
